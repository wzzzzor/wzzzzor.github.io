---
title: 单件模式
date: 2019-09-02 23:28:04
tags: [设计模式]
---



## 定义

单件模式（单例模式）确保一个类只有一个实例，并提供一个全局访问点



## 实现方法

- 方法一

  如果getInstance()的性能对应用程序不是很关键，就什么都别做

  ```java
  public class Singleton {
      private static Singleton uniqueSingleton;
  
      private Singleton(){
  
      }
  
      public  static Singleton getInstance(){
          if (uniqueSingleton == null){
              uniqueSingleton = new Singleton();
          }
          return uniqueSingleton;
      }
  }
  ```

- 方法二

  在方法一的基础之上加上同步，这样做会影响性能

  ```java
  public class Singleton {
      private static Singleton uniqueSingleton;
  
      private Singleton(){
  
      }
  
      public synchronized static Singleton getInstance(){
          if (uniqueSingleton == null){
              uniqueSingleton = new Singleton();
          }
          return uniqueSingleton;
      }
  }
  ```

  

- 方法三

  使用“急切”的创建实例，而不用延迟实例化的做法

  ```java
  public class Singleton {
      private static Singleton uniqueSingleton = new Singleton();
  
      private Singleton(){
  
      }
  
      public  static Singleton getInstance(){
          return uniqueSingleton;
      }
  }
  ```

  

- 方法四

  用“双重检查加锁”，在getInstance()中减少使用同步

  ```java
  public class Singleton {
      /**
       * volitile关键词确保：当uniqueSingleton变量被初始化成Singleton实例时，
       * 多个线程正确地处理uniqueSingleton变量。
       */
      private volatile static Singleton uniqueSingleton;
  
      private Singleton(){
  
      }
  
      public  static Singleton getInstance(){
          //检查实例，如果不存在，就进入同步区域块
          //注意：只有第一次才彻底执行这里的代码
          if (uniqueSingleton == null){
              synchronized (Singleton.class){
                  //进入区块后，再检查一次。如果仍然是null，才创建实例。
                  if (uniqueSingleton == null){
                      uniqueSingleton = new Singleton();
                  }
              }
          }
          return uniqueSingleton;
      }
  }
  ```

  